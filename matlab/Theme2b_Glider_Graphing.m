% Theme 2B - Ocean Circulation, Mixing, and Ecosystems

% OOI Data Labs Education Nuggets (part of the NSF-funded OOI Synthesis & Education project)

% Written by Leslie Smith, Your Ocean Consulting, LLC

% Objective: Graph Glider data from a csv file for the 
% "Coastal Upwelling Along the Northern California Current" data nugget 
% (https://datalab.marine.rutgers.edu/data-nuggets/coastal-upwelling/). These 
% data can be downloaded from the nugget website, or generated from the 
% following Python notebook (https://github.com/ooi-data-lab/nugget-notebooks/blob/master/notebooks/Theme2b_Endurance_coastal_upwelling.ipynb)

% Clear all variables and close all open matlab figures
clear all
close all
clc

%%   SELECT PROFILE DATASET TO RUN

INPUT = 'Theme2b_Endurance_glider_data_depthavg.csv';
Figure_Title = 'Endurace Array Glider Data';                                   

%%   LOAD THE DATA AND ASSIGN VARIABLES

% Loads the data file in CSV format
INPUTData = importdata(INPUT, ',', 1);

% Assign variables from the columns in the datafile. Remember that you
% count text columns and data columns separate.
p = INPUTData.data(:,1);            % Pressure (dbar)
t = INPUTData.data(:,2);            % Temperature(C)
lat = INPUTData.data(:,3);          % Latitude (degrees)
lon = INPUTData.data(:,4);          % Longitude (degrees
chl = INPUTData.data(:,5);          % Chlorophyll (ug L-1)

%% Make Colored Scatterplots

% Colored Scatterplots
s1 = subplot(2,1,1)
  q=scatter3(lon,p,0*lon,12,t,'.');
  view([0 -90]);
  q.SizeData=100;
  colormap(s1,'jet')
  cbh=colorbar;
  ylabel(cbh,'Temperature (C)');
  
s2 = subplot(2,1,2)
  v=scatter3(lon,p,0*lon,12,chl,'.');
  view([0 -90]);
  xlabel('Longitude (degrees West)');
  v.SizeData=100;
  chlmap = [0.242200002074242 0.150399997830391 0.660300016403198;0.242464289069176 0.186033070087433 0.654546856880188;0.24272857606411 0.221666142344475 0.648793637752533;0.242992863059044 0.257299214601517 0.643040478229523;0.243257150053978 0.292932271957397 0.637287318706512;0.243521422147751 0.328565359115601 0.631534159183502;0.243785709142685 0.364198416471481 0.625780940055847;0.244049996137619 0.399831473827362 0.620027780532837;0.244314283132553 0.435464560985565 0.614274621009827;0.244578570127487 0.471097618341446 0.608521461486816;0.244842857122421 0.506730675697327 0.602768242359161;0.245107144117355 0.54236376285553 0.597015082836151;0.245371431112289 0.577996850013733 0.591261923313141;0.245635718107224 0.613629877567291 0.585508704185486;0.245899990200996 0.649262964725494 0.579755544662476;0.24616427719593 0.684896051883698 0.574002385139465;0.246428564190865 0.720529139041901 0.568249225616455;0.246692851185799 0.756162166595459 0.5624960064888;0.246957138180733 0.791795253753662 0.55674284696579;0.270569831132889 0.791099488735199 0.538184881210327;0.294182538986206 0.790403723716736 0.519626975059509;0.317795217037201 0.789707958698273 0.501069068908691;0.341407924890518 0.78901219367981 0.482511103153229;0.365020632743835 0.788316428661346 0.463953167200089;0.38863331079483 0.787620663642883 0.445395231246948;0.412246018648148 0.78692489862442 0.426837295293808;0.435858726501465 0.786229133605957 0.408279359340668;0.45947140455246 0.785533308982849 0.389721423387527;0.483084112405777 0.784837543964386 0.371163487434387;0.506696820259094 0.784141778945923 0.352605551481247;0.530309498310089 0.78344601392746 0.334047615528107;0.553922176361084 0.782750248908997 0.315489679574966;0.577534914016724 0.782054483890533 0.296931743621826;0.601147592067719 0.78135871887207 0.278373807668686;0.624760270118713 0.780662953853607 0.259815871715546;0.648373007774353 0.779967188835144 0.241257935762405;0.671985685825348 0.779271423816681 0.222699999809265;0.687422811985016 0.776188552379608 0.219680950045586;0.702859997749329 0.77310574054718 0.216661900281906;0.718297123908997 0.770022869110107 0.213642850518227;0.733734250068665 0.766939997673035 0.210623815655708;0.749171435832977 0.763857126235962 0.207604765892029;0.764608561992645 0.760774314403534 0.204585716128349;0.780045688152313 0.757691442966461 0.20156666636467;0.795482873916626 0.754608571529388 0.19854761660099;0.810920000076294 0.751525700092316 0.195528566837311;0.826357126235962 0.748442888259888 0.192509517073631;0.841794312000275 0.745360016822815 0.189490467309952;0.857231438159943 0.742277145385742 0.186471432447433;0.872668564319611 0.739194273948669 0.183452382683754;0.888105750083923 0.736111462116241 0.180433332920074;0.903542876243591 0.733028590679169 0.177414283156395;0.9096559882164 0.753934562206268 0.169338092207909;0.915769040584564 0.774840474128723 0.161261901259422;0.921882152557373 0.795746445655823 0.153185710310936;0.927995264530182 0.816652417182922 0.14510951936245;0.934108316898346 0.837558329105377 0.137033328413963;0.940221428871155 0.858464300632477 0.128957137465477;0.946334540843964 0.879370272159576 0.120880953967571;0.952447593212128 0.900276184082031 0.112804763019085;0.958560705184937 0.921182155609131 0.104728572070599;0.964673817157745 0.94208812713623 0.0966523811221123;0.970786869525909 0.962994039058685 0.0885761901736259;0.976899981498718 0.983900010585785 0.0804999992251396];
  colormap(s2,chlmap)
  cbh=colorbar;
  ylabel(cbh,'Chlorophyll a (ug/L)');
 
% Standardize settings across all plots
for ax=[s1,s2]
    grid(ax,'off');
    set(ax,'fontsize',8);
    ylabel(ax,'Pressure (dbar)')
end

% Set size of the plot
set(gcf,'position',[680 42 1045 954]);

% Add the title to the first plot using the title you inputted in Line 18
title(s1,Figure_Title,'fontsize', 16)

% If you want to manually tweak the color maps further see 'colormapeditor'